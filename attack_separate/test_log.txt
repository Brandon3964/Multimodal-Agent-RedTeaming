/home/samhuang/SeeAct_RedTeaming/attack_env/lib/python3.11/site-packages/huggingface_hub/file_download.py:896: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:01<00:01,  1.65s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.06s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:02<00:00,  1.15s/it]
/home/samhuang/SeeAct_RedTeaming/attack/attack/llava_model.py:334: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=self.dtype):
/home/samhuang/SeeAct_RedTeaming/attack_env/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:410: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.2` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
Generated text: A motorcycle is parked in a grassy field.
Target text: a blue motorcycle with cat
Accuracy: 0.24390243902439024
  0%|          | 0/4000 [00:00<?, ?it/s]/home/samhuang/SeeAct_RedTeaming/attack/attack/llava_model.py:424: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with torch.cuda.amp.autocast(dtype=self.dtype):
  0%|          | 1/4000 [00:00<35:05,  1.90it/s]  0%|          | 2/4000 [00:00<31:04,  2.14it/s]  0%|          | 3/4000 [00:01<31:03,  2.14it/s]  0%|          | 4/4000 [00:01<31:03,  2.14it/s]  0%|          | 5/4000 [00:02<31:05,  2.14it/s]  0%|          | 6/4000 [00:02<31:04,  2.14it/s]  0%|          | 7/4000 [00:03<31:03,  2.14it/s]  0%|          | 8/4000 [00:03<31:03,  2.14it/s]  0%|          | 9/4000 [00:04<31:02,  2.14it/s]  0%|          | 10/4000 [00:04<31:02,  2.14it/s]  0%|          | 11/4000 [00:05<31:01,  2.14it/s]  0%|          | 12/4000 [00:05<31:01,  2.14it/s]  0%|          | 13/4000 [00:06<31:01,  2.14it/s]  0%|          | 14/4000 [00:06<31:01,  2.14it/s]  0%|          | 15/4000 [00:07<31:00,  2.14it/s]  0%|          | 16/4000 [00:07<31:00,  2.14it/s]  0%|          | 17/4000 [00:07<31:00,  2.14it/s]  0%|          | 18/4000 [00:08<30:59,  2.14it/s]  0%|          | 19/4000 [00:08<30:59,  2.14it/s]  0%|          | 20/4000 [00:09<30:58,  2.14it/s]  1%|          | 21/4000 [00:09<30:59,  2.14it/s]  1%|          | 22/4000 [00:10<30:58,  2.14it/s]  1%|          | 23/4000 [00:10<30:57,  2.14it/s]  1%|          | 24/4000 [00:11<30:56,  2.14it/s]  1%|          | 25/4000 [00:11<30:57,  2.14it/s]  1%|          | 26/4000 [00:12<30:56,  2.14it/s]  1%|          | 27/4000 [00:12<30:55,  2.14it/s]  1%|          | 28/4000 [00:13<30:55,  2.14it/s]  1%|          | 29/4000 [00:13<30:54,  2.14it/s]  1%|          | 30/4000 [00:14<30:53,  2.14it/s]  1%|          | 31/4000 [00:14<30:53,  2.14it/s]  1%|          | 32/4000 [00:14<30:53,  2.14it/s]  1%|          | 33/4000 [00:15<30:52,  2.14it/s]  1%|          | 34/4000 [00:15<30:51,  2.14it/s]  1%|          | 35/4000 [00:16<30:52,  2.14it/s]  1%|          | 36/4000 [00:16<30:51,  2.14it/s]  1%|          | 37/4000 [00:17<30:50,  2.14it/s]  1%|          | 38/4000 [00:17<30:52,  2.14it/s]  1%|          | 39/4000 [00:18<30:50,  2.14it/s]  1%|          | 40/4000 [00:18<30:49,  2.14it/s]  1%|          | 41/4000 [00:19<30:49,  2.14it/s]  1%|          | 42/4000 [00:19<30:48,  2.14it/s]  1%|          | 43/4000 [00:20<30:47,  2.14it/s]  1%|          | 44/4000 [00:20<30:47,  2.14it/s]  1%|          | 45/4000 [00:21<30:47,  2.14it/s]  1%|          | 46/4000 [00:21<30:47,  2.14it/s]  1%|          | 47/4000 [00:21<30:46,  2.14it/s]  1%|          | 48/4000 [00:22<30:45,  2.14it/s]  1%|          | 49/4000 [00:22<30:45,  2.14it/s]  1%|▏         | 50/4000 [00:23<30:44,  2.14it/s]  1%|▏         | 51/4000 [00:23<30:43,  2.14it/s]  1%|▏         | 52/4000 [00:24<30:43,  2.14it/s]  1%|▏         | 53/4000 [00:24<30:42,  2.14it/s]  1%|▏         | 54/4000 [00:25<30:42,  2.14it/s]  1%|▏         | 55/4000 [00:25<30:42,  2.14it/s]  1%|▏         | 56/4000 [00:26<30:41,  2.14it/s]  1%|▏         | 57/4000 [00:26<30:41,  2.14it/s]  1%|▏         | 58/4000 [00:27<30:40,  2.14it/s]  1%|▏         | 59/4000 [00:27<30:40,  2.14it/s]  2%|▏         | 60/4000 [00:28<30:41,  2.14it/s]  2%|▏         | 61/4000 [00:28<30:40,  2.14it/s]  2%|▏         | 62/4000 [00:28<30:39,  2.14it/s]  2%|▏         | 63/4000 [00:29<30:38,  2.14it/s]  2%|▏         | 64/4000 [00:29<30:37,  2.14it/s]  2%|▏         | 65/4000 [00:30<30:37,  2.14it/s]  2%|▏         | 66/4000 [00:30<30:36,  2.14it/s]  2%|▏         | 67/4000 [00:31<30:36,  2.14it/s]  2%|▏         | 68/4000 [00:31<30:36,  2.14it/s]  2%|▏         | 69/4000 [00:32<30:35,  2.14it/s]  2%|▏         | 70/4000 [00:32<30:35,  2.14it/s]  2%|▏         | 71/4000 [00:33<30:34,  2.14it/s]  2%|▏         | 72/4000 [00:33<30:34,  2.14it/s]  2%|▏         | 73/4000 [00:34<30:33,  2.14it/s]  2%|▏         | 74/4000 [00:34<30:33,  2.14it/s]  2%|▏         | 75/4000 [00:35<30:34,  2.14it/s]  2%|▏         | 76/4000 [00:35<30:33,  2.14it/s]  2%|▏         | 77/4000 [00:35<30:32,  2.14it/s]  2%|▏         | 78/4000 [00:36<30:31,  2.14it/s]  2%|▏         | 79/4000 [00:36<30:31,  2.14it/s]  2%|▏         | 80/4000 [00:37<30:30,  2.14it/s]  2%|▏         | 81/4000 [00:37<30:31,  2.14it/s]  2%|▏         | 82/4000 [00:38<30:30,  2.14it/s]  2%|▏         | 83/4000 [00:38<30:29,  2.14it/s]  2%|▏         | 84/4000 [00:39<30:28,  2.14it/s]  2%|▏         | 85/4000 [00:39<30:28,  2.14it/s]  2%|▏         | 86/4000 [00:40<30:28,  2.14it/s]  2%|▏         | 87/4000 [00:40<30:27,  2.14it/s]  2%|▏         | 88/4000 [00:41<30:26,  2.14it/s]  2%|▏         | 89/4000 [00:41<30:26,  2.14it/s]  2%|▏         | 90/4000 [00:42<30:25,  2.14it/s]  2%|▏         | 91/4000 [00:42<30:25,  2.14it/s]  2%|▏         | 92/4000 [00:42<30:25,  2.14it/s]  2%|▏         | 93/4000 [00:43<30:24,  2.14it/s]  2%|▏         | 94/4000 [00:43<30:25,  2.14it/s]  2%|▏         | 95/4000 [00:44<30:24,  2.14it/s]  2%|▏         | 96/4000 [00:44<30:23,  2.14it/s]  2%|▏         | 97/4000 [00:45<30:22,  2.14it/s]  2%|▏         | 98/4000 [00:45<30:22,  2.14it/s]  2%|▏         | 99/4000 [00:46<30:21,  2.14it/s]  2%|▎         | 100/4000 [00:46<30:20,  2.14it/s]  3%|▎         | 101/4000 [00:47<30:20,  2.14it/s]  3%|▎         | 102/4000 [00:47<30:20,  2.14it/s]  3%|▎         | 103/4000 [00:48<30:19,  2.14it/s]  3%|▎         | 104/4000 [00:48<30:18,  2.14it/s]  3%|▎         | 105/4000 [00:49<30:19,  2.14it/s]  3%|▎         | 106/4000 [00:49<30:18,  2.14it/s]  3%|▎         | 107/4000 [00:49<30:18,  2.14it/s]  3%|▎         | 108/4000 [00:50<30:17,  2.14it/s]  3%|▎         | 109/4000 [00:50<30:17,  2.14it/s]  3%|▎         | 110/4000 [00:51<30:16,  2.14it/s]  3%|▎         | 111/4000 [00:51<30:15,  2.14it/s]  3%|▎         | 112/4000 [00:52<30:15,  2.14it/s]  3%|▎         | 113/4000 [00:52<30:14,  2.14it/s]  3%|▎         | 114/4000 [00:53<30:14,  2.14it/s]  3%|▎         | 115/4000 [00:53<30:14,  2.14it/s]  3%|▎         | 116/4000 [00:54<30:13,  2.14it/s]  3%|▎         | 117/4000 [00:54<30:12,  2.14it/s]  3%|▎         | 118/4000 [00:55<30:12,  2.14it/s]  3%|▎         | 119/4000 [00:55<30:12,  2.14it/s]  3%|▎         | 120/4000 [00:56<30:11,  2.14it/s]  3%|▎         | 121/4000 [00:56<30:11,  2.14it/s]  3%|▎         | 122/4000 [00:56<30:11,  2.14it/s]  3%|▎         | 123/4000 [00:57<30:10,  2.14it/s]  3%|▎         | 124/4000 [00:57<30:10,  2.14it/s]  3%|▎         | 125/4000 [00:58<30:09,  2.14it/s]  3%|▎         | 126/4000 [00:58<30:08,  2.14it/s]  3%|▎         | 127/4000 [00:59<30:08,  2.14it/s]  3%|▎         | 128/4000 [00:59<30:07,  2.14it/s]  3%|▎         | 129/4000 [01:00<30:07,  2.14it/s]  3%|▎         | 130/4000 [01:00<30:06,  2.14it/s]  3%|▎         | 131/4000 [01:01<30:06,  2.14it/s]  3%|▎         | 132/4000 [01:01<30:05,  2.14it/s]  3%|▎         | 133/4000 [01:02<30:07,  2.14it/s]  3%|▎         | 134/4000 [01:02<30:06,  2.14it/s]  3%|▎         | 135/4000 [01:03<30:05,  2.14it/s]  3%|▎         | 136/4000 [01:03<30:04,  2.14it/s]  3%|▎         | 137/4000 [01:03<30:03,  2.14it/s]  3%|▎         | 138/4000 [01:04<30:02,  2.14it/s]  3%|▎         | 139/4000 [01:04<30:01,  2.14it/s]  4%|▎         | 140/4000 [01:05<30:01,  2.14it/s]  4%|▎         | 141/4000 [01:05<30:01,  2.14it/s]  4%|▎         | 142/4000 [01:06<30:00,  2.14it/s]  4%|▎         | 143/4000 [01:06<30:00,  2.14it/s]  4%|▎         | 144/4000 [01:07<30:00,  2.14it/s]  4%|▎         | 145/4000 [01:07<30:00,  2.14it/s]  4%|▎         | 146/4000 [01:08<29:59,  2.14it/s]  4%|▎         | 147/4000 [01:08<29:59,  2.14it/s]  4%|▎         | 148/4000 [01:09<29:59,  2.14it/s]  4%|▎         | 149/4000 [01:09<29:58,  2.14it/s]  4%|▍         | 150/4000 [01:10<29:57,  2.14it/s]  4%|▍         | 151/4000 [01:10<29:57,  2.14it/s]  4%|▍         | 152/4000 [01:11<29:58,  2.14it/s]  4%|▍         | 153/4000 [01:11<29:57,  2.14it/s]  4%|▍         | 154/4000 [01:11<29:56,  2.14it/s]  4%|▍         | 155/4000 [01:12<29:56,  2.14it/s]  4%|▍         | 156/4000 [01:12<29:55,  2.14it/s]  4%|▍         | 157/4000 [01:13<29:54,  2.14it/s]  4%|▍         | 158/4000 [01:13<29:54,  2.14it/s]  4%|▍         | 159/4000 [01:14<29:53,  2.14it/s]  4%|▍         | 160/4000 [01:14<29:53,  2.14it/s]  4%|▍         | 161/4000 [01:15<29:52,  2.14it/s]  4%|▍         | 162/4000 [01:15<29:52,  2.14it/s]  4%|▍         | 163/4000 [01:16<29:51,  2.14it/s]  4%|▍         | 164/4000 [01:16<29:51,  2.14it/s]  4%|▍         | 165/4000 [01:17<29:51,  2.14it/s]  4%|▍         | 166/4000 [01:17<29:52,  2.14it/s]  4%|▍         | 167/4000 [01:18<29:51,  2.14it/s]  4%|▍         | 168/4000 [01:18<29:50,  2.14it/s]  4%|▍         | 169/4000 [01:18<29:49,  2.14it/s]  4%|▍         | 170/4000 [01:19<29:48,  2.14it/s]  4%|▍         | 171/4000 [01:19<29:48,  2.14it/s]  4%|▍         | 172/4000 [01:20<29:47,  2.14it/s]  4%|▍         | 173/4000 [01:20<29:47,  2.14it/s]  4%|▍         | 174/4000 [01:21<29:47,  2.14it/s]  4%|▍         | 175/4000 [01:21<29:46,  2.14it/s]  4%|▍         | 176/4000 [01:22<29:45,  2.14it/s]  4%|▍         | 177/4000 [01:22<29:45,  2.14it/s]  4%|▍         | 178/4000 [01:23<29:44,  2.14it/s]  4%|▍         | 179/4000 [01:23<29:44,  2.14it/s]  4%|▍         | 180/4000 [01:24<29:43,  2.14it/s]  5%|▍         | 181/4000 [01:24<29:43,  2.14it/s]  5%|▍         | 182/4000 [01:25<29:43,  2.14it/s]  5%|▍         | 183/4000 [01:25<29:42,  2.14it/s]  5%|▍         | 184/4000 [01:25<29:42,  2.14it/s]  5%|▍         | 185/4000 [01:26<29:41,  2.14it/s]  5%|▍         | 186/4000 [01:26<29:41,  2.14it/s]  5%|▍         | 187/4000 [01:27<29:40,  2.14it/s]  5%|▍         | 188/4000 [01:27<29:41,  2.14it/s]  5%|▍         | 189/4000 [01:28<29:40,  2.14it/s]  5%|▍         | 190/4000 [01:28<29:39,  2.14it/s]  5%|▍         | 191/4000 [01:29<29:39,  2.14it/s]  5%|▍         | 192/4000 [01:29<29:38,  2.14it/s]  5%|▍         | 193/4000 [01:30<29:38,  2.14it/s]  5%|▍         | 194/4000 [01:30<29:37,  2.14it/s]  5%|▍         | 195/4000 [01:31<29:37,  2.14it/s]  5%|▍         | 196/4000 [01:31<29:36,  2.14it/s]  5%|▍         | 197/4000 [01:32<29:36,  2.14it/s]  5%|▍         | 198/4000 [01:32<29:35,  2.14it/s]  5%|▍         | 199/4000 [01:32<29:34,  2.14it/s]  5%|▍         | 199/4000 [01:34<29:58,  2.11it/s]
Loss: 0.031486626714468
Generated text: a blue motorcycle with cat
Target text: a blue motorcycle with cat
Accuracy: 1.0
Generated text: a blue motorcycle with cat
Target text: a blue motorcycle with cat
Accuracy: 1.0
Adv caption: a blue motorcycle with cat
Target caption: ['a blue motorcycle with cat']
Accuracy: 1.0
Adversarial image saved as adv_image.jpg
